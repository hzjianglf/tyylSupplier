<div id="cc" class="easyui-layout" data-options="fit:true" >
##    <div data-options="region:'north'" style="height:35px;padding:3px">
##        <a class="easyui-linkbutton" onclick="saveGoldgridFile('/upload_files/xx.doc')" data-options="iconCls:'icon-search',plain:true">保存</a>
##    </div>
    <div data-options="region:'center',border:false">
        <object id="WebOffice2015"  width="100%" height="100%"
                classid="clsid:D89F482C-5045-4DB5-8C53-D2C9EE71D025"
                codebase="$link.getContextURL()/lib/goldgrid/iWebOffice2015.cab#version=12,2,0,382">
		<param name="Copyright" value="金格科技iWebOffice2015智能文档中间件[演示版];V5.0S0xGAAEAAAAAAAAAEAAAAGgBAABwAQAALAAAAJO0tDPyRkWjG0ECvwREdD7dkaLgVLm/CUjO2XXbREPUSpqj1x/HuzereBWBwjaJ+2c7vHB7ojJ007BGscZGLdp4OW3E1CrqgnDORgkIaMAF1OrtKbx3UdMd4gKUOoMH/N5KeJ6SUGKUufcSfjh2VRfHXUomgSpRYmcTCjyST+AA8UhPPiY8RHtEQy0fSGsfU7nObsAG/IlU2zMv/xI+3gbdT1/mzC8O1P1NQc8F6f/4oatmsHJPrS/QnX5Ezyd5fJCCSXgNrA4BXhNL2oQkOS9lgYP1Xjxadu90iPJDq229ItsCQSozdKMha1Df1ffIOtYfetuBzUAAM4fmo+MRwpaq+OMMcu3DrjX2/AfY/LnHxudLs4yo5y6RVjb6l0DdMhTLqEoLZdU3r/kGqo6H+7s+DejC2Vtd/DJlUQDTHnEzhZUBTF5OVra0hxZRsE9HgWWoykNNbrS88jdsOWGz5TzEHSiwA+LKpuuUb3ACab7Dj67mQcl1ttDajzpScs3uRQ==">
		</object>
    </div>
</div>
<script src="$link.getContextURL()/lib/goldgrid/WebOffice.js"  type="text/javascript"></script>
#@script()
<script type="text/javascript">
function OnReady(){
	WebOffice.setObj(document.getElementById('WebOffice2015'));//给2015对象赋值
	window.onload = function(){Load();} //IE和谷歌可以直接调用Load方法，火狐要在页面加载完后去调用
}
</script>
<script language="javascript" for="WebOffice2015" event="OnReady()">
   WebOffice.setObj(document.getElementById('WebOffice2015'));//给2015对象赋值
   Load();//避免页面加载完，控件还没有加载情况
</script>

<script>
	var WebOffice = new WebOffice2015(); //创建WebOffice对象
	
	$(function(){
		
    })
	
	function Load(){
 	  try{
 	  		WebOffice.WebUrl="$link.getContextURL()/common/goldgrid/OfficeServer";             //WebUrl:系统服务器路径，与服务器文件交互操作，如保存、打开文档，重要文件
            WebOffice.FileType=".doc";            //FileType:文档类型  .doc  .xls
			WebOffice.RecordID="1";            //RecordID:本文档记录编号
		    WebOffice.FileName="测试文档";            //FileName:文档名称
            WebOffice.UserName="$user.getCurrentUserName()";            //UserName:操作用户名，痕迹保留需要
            WebOffice.AppendMenu("1","打开本地文件(&L)");    //多次给文件菜单添加
            WebOffice.AppendMenu("2","保存本地文件(&S)");
            WebOffice.AppendMenu("3","-");
            WebOffice.AppendMenu("4","打印预览(&C)");
            WebOffice.AppendMenu("5","退出打印预览(&E)");
            WebOffice.AddCustomMenu();                       //一次性多次添加包含二次菜单
            WebOffice.Skin('purple');                        //设置皮肤
            WebOffice.HookEnabled();
            WebOffice.SetCaption();
            WebOffice.SetUser("$user.getCurrentUserName()");
			WebOffice.CreateFile();
            #*if(WebOffice.WebOpen()){                             //打开该文档    交互OfficeServer  调出文档OPTION="LOADFILE"
                WebOffice.VBASetUserName(WebOffice.UserName);    //设置用户名
                WebOffice.AddToolbar();//打开文档时显示手写签批工具栏
                WebOffice.ShowCustomToolbar(false);//隐藏手写签批工具栏
                StatusMsg(WebOffice.Status);
            }*#
 	  }catch(e){
 	     alert(e.description);       
 	  }
 	}
 	
 	//设置页面中的状态值
 	function StatusMsg(mValue){
 	   try{
	   document.getElementById('state').innerHTML = mValue;
	   }catch(e){
	     return false;
	   }
	}
	
</script>
#end
