<div class="easyui-layout" fit="true">
  <div id="tb" class="top-menu datagrid-toolbar toolbar-borderbottom">
     <a href="javascript:;" class="easyui-linkbutton" iconCls="icon-add" plain="true">新增</a>
     <a href="javascript:;" class="easyui-linkbutton" iconCls="icon-edit" plain="true">修改</a>
     ##<a href="javascript:;" class="easyui-linkbutton" iconCls="icon-remove" plain="true">停用</a>
     <i></i>
    <a  onclick="$('#searchDialog').css('display','block');$('#searchDialog').window('center');$('#searchDialog').window('open');"
        class="easyui-linkbutton l-btn-plain-search" data-options="iconCls:'icon-search',plain:true">查询</a>
    <a onclick="top.CC.closeCurTab()"
       class="easyui-linkbutton l-btn-plain-quit" data-options="iconCls:'icon-quit-small',plain:true">关闭</a>
  </div>
  <div class="cc-tableWrap" data-options="region:'center',border:false" style="padding:5px;">
    <table id="dg" data-options="nowrap:false" style="width:99%;">
      <thead>
      <tr>
        <th style="width:100px" data-options="field:'id'">流程编号</th>
        <th style="width:400px" data-options="field:'flowName',formatter:detailUrl">流程名称</th>
		<th style="width:100px" data-options="field:'flowSort'">类别</th>
        <th style="width:100px" data-options="field:'flowType'">分类</th>
        <th style="width:100px" data-options="field:'flowStatus'">状态</th>
        <th style="width:130px" data-options="field:'operate',align:'center',formatter:operateFormatter">操作</th>
      </tr>
      </thead>
    </table>
	<div class="cc-operateColum">
	    <a  href='javascript:;' class="easyui-linkbutton" iconCls="icon-edit"
	        plain="true" onclick='editFlow("__id__")'>编辑流程图</a>
	</div>
	<div  id="searchDialog" class="easyui-dialog  dialog-tc" title="查询条件" data-options="modal:true,closed:true,collapsible:false,minimizable:false,maximizable:false,buttons:'#bnts'"
     style="width:500px;height:230px;padding:20px 10px; background-color:#f4f4f4;display:none;">
    <form id="queryForm">
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
            <tr>
                <td style="text-align: right">流程名称：</td>
                <td colspan="3"><input name="$qc.like('flowName')" style="width:320px;" name="title" class="easyui-textbox" /></td>
            </tr>
            <tr>
                <td style="text-align: right">流程类别：</td>
                <td style="width:120px;">
                    <select name="$qc.equal('flowSort')" class="easyui-combobox" data-options="editable:false" style="width:120px;" panelheight="auto">
                        #formoption("" $dict.FlowSort)
                    </select>
                </td>
                <td align="right" style="width:100px;">流程分类：</td>
                <td align="left">
                    <select name="$qc.equal('flowType')" class="easyui-combobox" data-options="editable:false" style="width:100px;"
                        panelheight="auto">
                        #formoption("" $dict.WfBusinessType)
                    </select>
                </td>
            </tr>
        </table>
     </form>
    <div id="bnts" style="top:0px; height:25px; width:auto;">
        <a class="new-but" onclick="formSerach()">确定</a>
        <a class="new-but" onclick="reset()">重置</a>
    </div>
  </div>

  </div>
</div>
<div id="editWindow" class="easyui-window" title="编辑流程" style="width:550px;height:470px;padding:5px"
    data-options="closed:true,modal:true,minimizable:false,maximizable:false,collapsible:false">
</div>

#parse("common/easyui/operatorcolumn.js.vm")
#parse("workflow/flow/crud.js.vm")
#@script()
<script type="text/javascript">
    var _baseUrl = '$link.getContextURL()';
    var _listJsonUrl = '/workflow/flow/list.json';
    var _newJsonUrl = '/new';

    function operateFormatter(value,row,index){
        return $(".cc-operateColum",_datagrid.parents(".cc-tableWrap")).html().replace(new RegExp("__id__",'gm'),row.id);
    }

	function editFlow(id){
	    top.CC.addTab({title:'编辑流程图',url:'gooflow/index.html?edit=t&flowId='+id});

    }
	
	function formSerach() {
        $('#searchDialog').window('close');
        $('#dg').datagrid('reload');
    }

    function reset(){
        var _qf = $("#queryForm");
        _qf.form("clear");
        $(".easyui-combobox",_qf).each(function(){
            $(this).combobox("select"," ");
        });
    }

</script>
#end